services:
  - type: web
    name: pos-parent-agent-v3
    env: python
    plan: free
    region: singapore

    # -------------------
    # Build & Start Commands
    # -------------------
    buildCommand: |
      pip install --upgrade pip
      pip install -r requirements.txt

    startCommand: gunicorn -w 1 -b 0.0.0.0:$PORT parent_agent:app

    # -------------------
    # Environment Variables
    # -------------------
    envVars:
      # === Core AI + Notion Credentials ===
      - key: GROQ_API_KEY
        sync: false
      - key: NOTION_API_KEY
        sync: false
      - key: NOTION_DATABASE_ID
        sync: false

      # === Linked Child Agents ===
      - key: XP_AGENT_URL
        value: "https://xp-agent.onrender.com/award_xp"
      - key: CALENDAR_AGENT_URL
        value: "https://calendar-agent-7ofo.onrender.com/create_event"
      - key: EMAIL_AGENT_URL
        value: "https://email-agent-x7n0.onrender.com/create_draft"
      - key: RESEARCH_AGENT_URL
        value: "https://research-agent-ih4t.onrender.com/research"
      - key: MESSAGING_AGENT_URL
        value: "https://messaging-agent.onrender.com/notify"

      # === Runtime Configuration ===
      - key: PYTHON_VERSION
        value: 3.10

    # -------------------
    # Health Check
    # -------------------
    healthCheckPath: /
    autoDeploy: true
